# WeChat Database Manager

A comprehensive Tauri application for managing and browsing WeChat SQLCipher databases. This application provides a user-friendly interface to explore WeChat database contents, execute queries, and export data.

## Features

### Database Management
- **Automatic Key Parsing**: Parses `.keys` files generated by the WeChat database cracker
- **Database Connection**: Securely connects to SQLCipher databases using extracted keys
- **Database Browser**: Browse all available databases with metadata (size, type, accessibility)
- **Connection Pool**: Manages multiple database connections efficiently

### Data Exploration
- **Table Browser**: Navigate through database tables with column information
- **Data Viewer**: Browse table contents with pagination and search
- **Custom Queries**: Execute custom SQL queries with result visualization
- **Schema Inspector**: View table structures and column details

### Export & Analysis
- **CSV Export**: Export table data to CSV format
- **Query Results**: Export custom query results
- **Data Visualization**: View row counts, data types, and table statistics

### User Interface
- **Modern UI**: Clean, responsive interface built with React and Tailwind CSS
- **Database Types**: Color-coded database types (Messages, Contacts, Groups, etc.)
- **Real-time Updates**: Live data loading with loading states
- **Error Handling**: Comprehensive error handling with user-friendly messages

## Architecture

### Backend (Rust/Tauri)
- **SQLCipher Integration**: Uses `rusqlite` with SQLCipher support
- **Database Module**: Handles database parsing, connection, and queries
- **API Endpoints**: Exposes database operations to frontend
- **Security**: Secure key handling and database access

### Frontend (React/TypeScript)
- **Component Architecture**: Modular React components for different views
- **State Management**: React hooks for application state
- **API Integration**: Tauri invoke API for backend communication
- **Responsive Design**: Mobile-friendly interface with Tailwind CSS

## Usage

### 1. Prerequisites
- Rust development environment
- Node.js and pnpm
- SQLCipher libraries
- WeChat `.keys` file from the database cracker

### 2. Development Setup

```bash
# Install dependencies
pnpm install

# Start development server
pnpm tauri dev
```

### 3. Loading Database Keys

1. **Generate Keys**: First, use the WeChat database cracker to generate a `.keys` file
2. **Load Keys**: In the application, click "Load Keys File" to import your database configurations
3. **Browse Databases**: Select databases from the sidebar to view their tables

### 4. Exploring Data

1. **Select Database**: Click on a database in the left sidebar
2. **Connect**: The application will automatically connect to the selected database
3. **Browse Tables**: Select tables from the table list to view their contents
4. **Query Data**: Use the search button to execute custom SQL queries
5. **Export Data**: Click the download button to export table data as CSV

### 5. Database Types

The application recognizes these WeChat database types:
- **Messages**: Chat messages (msg_0.db to msg_9.db)
- **Contacts**: Contact information (wccontact_new2.db)
- **Groups**: Group information (group_new.db)
- **Sessions**: Session data (session_new.db)
- **Favorites**: Bookmarked content (favorites.db)
- **Media**: Media file metadata (mediaData.db)
- **Search**: Full-text search indexes (ftsmessage.db)

### 6. Security Considerations

- Database keys are handled securely in memory
- No persistent storage of encryption keys
- Read-only access to database files
- Connection pooling with proper cleanup

## File Structure

```
src/
├── components/
│   ├── DatabaseList.tsx    # Database browser component
│   ├── TableList.tsx       # Table browser component
│   └── TableView.tsx       # Data viewer component
├── api.ts                  # Backend API interface
├── types.ts               # TypeScript type definitions
├── App.tsx                # Main application component
└── main.tsx               # Application entry point

src-tauri/
├── src/
│   ├── database.rs        # Database management module
│   ├── lib.rs            # Tauri commands and setup
│   └── main.rs           # Application entry point
├── Cargo.toml            # Rust dependencies
└── tauri.conf.json       # Tauri configuration
```

## Build for Production

```bash
# Build the application
pnpm build

# Create distribution package
pnpm tauri build
```

## Troubleshooting

### Common Issues

1. **SQLCipher Connection Error**
   - Ensure SQLCipher is properly installed
   - Verify database file accessibility
   - Check if the database keys are correct

2. **Database Not Found**
   - Verify the `.keys` file path is correct
   - Check file permissions
   - Ensure the database files exist at the specified paths

3. **Table Loading Issues**
   - Verify database connection is established
   - Check if the database is encrypted correctly
   - Ensure proper SQLCipher compatibility settings

### Development Tips

1. **Adding New Database Types**
   - Update the `DB_TYPE_LABELS` and `DB_TYPE_COLORS` in `types.ts`
   - Modify the `extract_db_type` function in `database.rs`

2. **Custom Query Features**
   - Use the custom query input to explore database schemas
   - Common queries: `SELECT * FROM sqlite_master` to view all tables
   - Use `PRAGMA table_info(table_name)` to inspect table structure

3. **Performance Optimization**
   - Use pagination for large datasets
   - Limit query results with `LIMIT` clause
   - Index frequently queried columns

## Security Notes

This application is designed for legitimate database recovery and analysis purposes. It:
- Handles sensitive personal data with appropriate security measures
- Provides read-only access to database contents
- Implements proper encryption key management
- Follows security best practices for data handling

## License

This project is part of the WeChat Database Cracker suite and follows the same licensing terms.